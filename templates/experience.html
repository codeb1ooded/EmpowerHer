{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Experiences - {{ event_name }}</title>
  <link href="{% static 'css/layout.css' %}" rel="stylesheet" type="text/css" media="all">
  <link href="{% static 'css/experience.css' %}" rel="stylesheet" type="text/css" media="all">
  <link href="{% static 'css/nav_menu.css' %}" rel='stylesheet' type='text/css'>
</head>
<body>
    <header class="main_h sticky">
        <div class="row">
            <a class="logo" href="#">P/F</a>
            <div class="mobile-toggle"><span></span><span></span><span></span></div>
            <nav>   <ul>
                <li><a href="/">Home</a></li>
                <li><a href=".sec02">Share Experience</a></li>
                <li><a href=".sec03">Notifications</a></li>
                <li><a href=".sec04">User Profile</a></li>
            </ul>   </nav>
        </div>
    </header>
    <div class="experience-page-content">
        <a class="event-name" href="../event/?event_id={{event_id}}"> {{ event_name }} </a>
        {% for experience in all_experiences %}
        <div class="questions question-card">
            <div style="width: 100%;">
              <div style="float:left; width: 10%">
                  <img src="{% static 'images/avatar.png' %}" alt="">
              </div>
              <div style="">
                  <username> By <a href="#">{{ experience.name }}</a> </username>
                  <br/>
                  <time>{{ experience.timestamp }}</time>
              </div>
            </div>
            <div style="clear:both"></div>
            <div>{{ experience.experience }} </div>
            <div class="upvote-experience {% if experience.is_upvoted %} upvoted-button {% else %} upvote-button {% endif %}"
            data-expid="{{experience.experience_id}}" data-state="{{experience.is_upvoted}}">
                <span id="text-{{ experience.experience_id }}"> {% if experience.is_upvoted %} Upvoted {% else %} Upvote {% endif %} </span> |
                <span id="upvote-{{ experience.experience_id }}"> {{ experience.upvotes }} </span> </div>
        </div>
        {% endfor %}
    </div>

  <script type="text/javascript" src="https://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/jquery.backtotop.js' %}"></script>
  <script src="{% static 'js/jquery.mobilemenu.js' %}"></script>
  <script>
      $(document).ready(function() {
          $('.upvote-experience').click(function(){
              var expid, oldstate, newstate;
              expid = $(this).attr("data-expid");
              oldstate = $(this).attr("data-state");
              if (oldstate === "False") {
                  $(this).addClass('upvoted-button').removeClass('upvote-button');
                  newstate =  "True";
                  $(this).attr('data-state', "True");
                  $('#text-' + expid).html("Upvoted");
              }
              else {
                  $(this).addClass('upvote-button').removeClass('upvoted-button');
                  newstate = "False";
                  $(this).attr('data-state', "False");
                  $('#text-' + expid).html("Upvote");
              }
              $.get('/upvote_experience/', {experience_id: expid, state: newstate, username: "{{ username }}"}, function(data){
                  $('#upvote-' + expid).html(data);
              });
          });
      });
  </script>
  <script src="{% static '/js/nav_menu.js' %}"></script>
</body>
</html>
